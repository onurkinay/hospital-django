{% extends 'management_base.html' %}

{% load static %}
{% block title %}
  Edit Appointment
{% endblock %}
{% block content %}
  <form method="post">
    {% csrf_token %}
    <section id="ozel-sayfa">
      <h2 style="margin-left: 13%;">Create Appointment</h2>

      {{ form.non_field_errors }}
      <div class="container" style="display:block">
        <div class="kisisel-bilgiler" style="width:initial">
          <!-- DOKTORUN GÖRECEĞİ KISIM -->
          <div class="form-group">
            <label for="doktor-id">Patient:</label>
            <label for="Patient_One">Patient One</label>
            <a href="/Patients/Details/1" class="getDetails">Get Details</a>
          </div>
          <!-- HASTANIN GÖRECEĞİ KISIM -->
          <div class="form-group">
            <label for="patient-id">Doctor:</label>
            <label for="Patient_One">Doctor One</label>
            <a href="/Doctors/Details/1" class="getDetails">Get Details</a>
          </div>
          <ul>
            {% for field in form %}
              <li>
                {{ field.errors }}
                {{ field.label_tag }}

                {{ field }}

                {% if field.help_text %}
                  <p class="help" id="{{ field.auto_id }}_helptext">{{ field.help_text|safe }}</p>
                {% endif %}
              </li>
            {% endfor %}
            <li>
              <button type="submit">Send</button>
            </li>
          </ul>
        </div>
      </div>
    </section>
  </form>

  <div id="ex1" class="modal">
    <section id="ozel-sayfa" style="padding:0;margin-bottom:0">
      <div class="container" style="max-width:initial">
        <!-- doctor -->
        <div class="kisisel-bilgiler" style="width:100%">
          <h3>Patient</h3>
          <ul>
            <li class="patientNameSurname"></li>
            <li class="patientBlood"></li>
          </ul>
        </div>
        <!-- patient -->
        <div class="kisisel-bilgiler">
          <h3>Doctor</h3>
          <ul>
            <li class="doctorNameSurname"></li>
            <li class="doctorDept"></li>
          </ul>
        </div>
      </div>
    </section>
  </div>

  <script>
    $('.getDetails').click(function (event) {
      //doctor
      event.preventDefault()
      this.blur()
      $.get(this.href, function (html) {
        const patient = html[0]
        $('li.patientNameSurname').html('<span>Name Surname:</span> ' + patient.Name + ' ' + patient.Surname)
        $('li.patientBlood').html('<span>Blood Group:</span> ' + patient.Blood_Group)
        $('#ex1').modal()
      })
    })
    
    $('.getDetails').click(function (event) {
      //doctor
      event.preventDefault()
      this.blur()
      $.get(this.href, function (html) {
        const dector = html[0]
        $('li.doctorNameSurname').html('<span>Name Surname:</span> ' + doctor.Name + ' ' + Doctor.Surname)
        $('li.doctorDept').html('<span>Blood Group:</span> ' + doctor.Blood_Group) //dept name
        $('#ex1').modal()
      })
    })
  </script>
{% endblock %}
